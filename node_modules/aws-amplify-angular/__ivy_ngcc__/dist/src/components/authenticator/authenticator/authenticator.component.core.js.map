{"version":3,"file":"authenticator.component.core.js","sources":["../../../../../src/components/authenticator/authenticator/authenticator.component.core.ts"],"names":[],"mappings":"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","sourcesContent":["// tslint:disable\n/*\n * Copyright 2017-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\"). You may not use this file except in compliance with\n * the License. A copy of the License is located at\n *\n *     http://aws.amazon.com/apache2.0/\n *\n * or in the \"license\" file accompanying this file. This file is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n * CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions\n * and limitations under the License.\n */\n// tslint:enable\n\nimport { Component, Input, ViewEncapsulation, OnInit } from '@angular/core';\nimport { AmplifyService, AuthState } from '../../../providers';\n\nconst template = `\n  <div class=\"amplify-authenticator\">\n    <amplify-auth-sign-in-core\n      *ngIf=\"!shouldHide('SignIn')\"\n      [authState]=\"authState\"\n      [usernameAttributes]=\"_usernameAttributes\"\n      [hide]=\"hide\"\n    ></amplify-auth-sign-in-core>\n\n    <amplify-auth-sign-up-core\n      *ngIf=\"!shouldHide('SignUp')\"\n      [authState]=\"authState\"\n      [signUpConfig]=\"_signUpConfig\"\n      [usernameAttributes]=\"_usernameAttributes\"\n      [hide]=\"hide\"\n    ></amplify-auth-sign-up-core>\n\n    <amplify-auth-confirm-sign-up-core\n      *ngIf=\"!shouldHide('ConfirmSignUp')\"\n      [authState]=\"authState\"\n      [usernameAttributes]=\"_usernameAttributes\"\n      [hide]=\"hide\"\n    ></amplify-auth-confirm-sign-up-core>\n\n    <amplify-auth-confirm-sign-in-core\n      *ngIf=\"!shouldHide('ConfirmSignIn')\"\n      [authState]=\"authState\"\n      [hide]=\"hide\"\n    ></amplify-auth-confirm-sign-in-core>\n\n    <amplify-auth-forgot-password-core\n      *ngIf=\"!shouldHide('ForgotPassword')\"\n      [authState]=\"authState\"\n      [usernameAttributes]=\"_usernameAttributes\"\n      [hide]=\"hide\"\n    ></amplify-auth-forgot-password-core>\n\n    <amplify-auth-greetings-core\n    *ngIf=\"!shouldHide('Greetings')\"\n    [authState]=\"authState\"\n    [usernameAttributes]=\"_usernameAttributes\"\n    ></amplify-auth-greetings-core>\n\n     <amplify-auth-require-new-password-core\n      *ngIf=\"!shouldHide('RequireNewPassword')\"\n      [authState]=\"authState\"\n      [hide]=\"hide\"\n    ></amplify-auth-require-new-password-core>\n  </div>\n`;\n\n@Component({\n\tselector: 'amplify-authenticator-core',\n\ttemplate,\n})\nexport class AuthenticatorComponentCore implements OnInit {\n\tauthState: AuthState = {\n\t\tstate: 'loading',\n\t\tuser: null,\n\t};\n\t_signUpConfig: any = {};\n\t_usernameAttributes: string = 'username';\n\n\tconstructor(public amplifyService: AmplifyService) {\n\t\tthis.subscribe();\n\t}\n\n\tngOnInit() {\n\t\tif (!this.amplifyService.auth()) {\n\t\t\tthrow new Error('Auth module not registered on AmplifyService provider');\n\t\t} else {\n\t\t\tconst loadStatus = this.amplifyService\n\t\t\t\t.auth()\n\t\t\t\t.currentAuthenticatedUser()\n\t\t\t\t.then(user => {\n\t\t\t\t\tif (this.authState.state === 'loading' && user) {\n\t\t\t\t\t\tthis.amplifyService.setAuthState({ state: 'signedIn', user });\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tif (this.authState.state === 'loading') {\n\t\t\t\t\t\tthis.amplifyService.setAuthState({ state: 'signIn', user: null });\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t}\n\n\t@Input()\n\thide: string[] = [];\n\n\t@Input()\n\tset data(data: any) {\n\t\tif (data.signUpConfig) {\n\t\t\tthis._signUpConfig = data.signUpConfig;\n\t\t}\n\t\tif (data.hide) {\n\t\t\tthis.hide = data.hide;\n\t\t}\n\n\t\tthis._usernameAttributes =\n\t\t\tdata.usernameAttributes || this._usernameAttributes || 'username';\n\t}\n\n\t@Input()\n\tset signUpConfig(signUpConfig: any) {\n\t\tthis._signUpConfig = signUpConfig;\n\t}\n\n\t@Input()\n\tset usernameAttributes(usernameAttributes: string) {\n\t\tthis._usernameAttributes = usernameAttributes || 'username';\n\t}\n\n\tsubscribe() {\n\t\tthis.amplifyService.authStateChange$.subscribe(\n\t\t\tstate => {\n\t\t\t\tthis.authState = state;\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tthis.authState = {\n\t\t\t\t\tstate: 'signIn',\n\t\t\t\t\tuser: null,\n\t\t\t\t};\n\t\t\t}\n\t\t);\n\t}\n\n\tshouldHide(comp) {\n\t\treturn this.hide.filter(item => item === comp).length > 0;\n\t}\n}\n"]}